<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EdVice - Career & Education Advisor{% endblock %}</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="{% block description %}Get personalized career guidance and discover the best government colleges in India. Take our aptitude quiz and find your ideal career path.{% endblock %}">
    <meta name="keywords" content="career guidance, education advisor, government colleges, aptitude test, career quiz, college finder, J&K education">
    <meta name="author" content="EdVice Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}EdVice - Career & Education Advisor{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Get personalized career guidance and discover the best government colleges in India.{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:image" content="{{ url_for('static', filename='images/MainLogo.png', _external=True) }}">
    <meta property="og:site_name" content="EdVice">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}EdVice - Career & Education Advisor{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Get personalized career guidance and discover the best government colleges in India.{% endblock %}">
    <meta name="twitter:image" content="{{ url_for('static', filename='images/MainLogo.png', _external=True) }}">
    
    <!-- Preconnect to external domains for performance -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaT2/5pQYdQN+4vD9LqJ8t8ec6/8etuWLfWwb/2Q8RB6X2vhddsOhgSJMBQ" crossorigin="anonymous">
    
    <!-- Feather Icons -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js" integrity="sha384-7k3CV2hoBFBqFfY8X7fNBE8dJ8R73C4/YfDVFd2Vc2YQ4U1Qf0Dc1+4t6f30V5Gv" crossorigin="anonymous"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chatbot.css') }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/MainLogo.png') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='images/MainLogo.png') }}">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "EducationalOrganization",
        "name": "EdVice",
        "description": "Career & Education Advisor for students in India",
        "url": "{{ request.url_root }}",
        "logo": "{{ url_for('static', filename='images/MainLogo.png', _external=True) }}",
        "sameAs": [
            "https://youtube.com/@techquesters-ai",
            "https://www.instagram.com/tech_questers2k24",
            "https://www.linkedin.com/company/tech-questers/"
        ]
    }
    </script>
    
    {% block extra_head %}{% endblock %}
    <style>
        /* Skip link for accessibility */
        .skip-link{position:absolute;left:-999px;top:auto;width:1px;height:1px;overflow:hidden}
        .skip-link:focus{left:8px;top:8px;width:auto;height:auto;background:#111827;color:#fff;padding:.5rem .75rem;border-radius:.5rem;z-index:1100}
        /* Active nav link */
        .navbar-nav .nav-link.active{color: var(--primary-blue) !important; background: rgba(37,99,235,.1)}
        /* Custom navbar toggle icon */
        .navbar-toggler{border:none;padding:.25rem .5rem}
        .navbar-toggler:focus{box-shadow:0 0 0 .25rem rgba(37,99,235,.25)}
        .navbar-toggle-icon{width:24px;height:24px;color:var(--text)}
        [data-theme="dark"] .navbar-toggle-icon{color:var(--text)}
        
        /* Enhanced Dark Mode Support */
        [data-theme="dark"] {
            color-scheme: dark;
        }
        [data-theme="dark"] body {
            background: var(--surface) !important;
            color: var(--text) !important;
        }
        [data-theme="dark"] .navbar {
            background: var(--surface) !important;
            border-bottom: 1px solid var(--border-gray);
        }
        [data-theme="dark"] .text-muted {
            color: var(--text-muted) !important;
        }
        [data-theme="dark"] .navbar-brand {
            color: var(--text) !important;
        }
        [data-theme="dark"] .dropdown-menu {
            background: var(--surface) !important;
            border: 1px solid var(--border-gray) !important;
        }
        [data-theme="dark"] .dropdown-item {
            color: var(--text) !important;
        }
        [data-theme="dark"] .dropdown-item:hover {
            background: var(--light-gray) !important;
            color: var(--text) !important;
        }
        
        /* Modern Theme Toggle with Icons */
        .theme-toggle{
            display:inline-flex;
            align-items:center;
            gap:.5rem;
            border:1px solid var(--border-gray);
            border-radius:50px;
            padding:.3rem .6rem;
            background:var(--surface);
            cursor:pointer;
            transition:all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .theme-toggle:hover{
            transform:translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        [data-theme="dark"] .theme-toggle{
            background:var(--surface);
            border-color:var(--border-gray);
            box-shadow: 0 2px 4px rgba(255,255,255,0.1);
        }
        [data-theme="dark"] .theme-toggle:hover{
            box-shadow: 0 4px 8px rgba(255,255,255,0.15);
        }
        .theme-toggle input{display:none}
        .theme-icon{
            width:16px;
            height:16px;
            color:var(--text);
            transition:all 0.3s ease;
        }
        .theme-toggle .sun-icon{
            opacity:1;
            transform:rotate(0deg);
        }
        .theme-toggle .moon-icon{
            opacity:0;
            transform:rotate(180deg);
            position:absolute;
        }
        [data-theme="dark"] .theme-toggle .sun-icon{
            opacity:0;
            transform:rotate(180deg);
        }
        [data-theme="dark"] .theme-toggle .moon-icon{
            opacity:1;
            transform:rotate(0deg);
            position:relative;
        }
        
        /* Mobile-specific theme toggle styling */
        .mobile-theme-toggle {
            border: none !important;
            background: transparent !important;
            box-shadow: none !important;
            padding: .5rem 0 !important;
            width: 100%;
            justify-content: flex-start;
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        .mobile-theme-toggle:hover {
            transform: none !important;
            box-shadow: none !important;
            background: rgba(37,99,235,.1) !important;
            border-radius: 6px !important;
        }
        [data-theme="dark"] .mobile-theme-toggle:hover {
            background: var(--light-gray) !important;
        }
        
        /* Hide desktop theme toggle on very small screens */
        @media (max-width: 576px) {
            .navbar-nav > li:not(.d-lg-none) .theme-toggle {
                display: none;
            }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .theme-toggle:not(.mobile-theme-toggle) {
                padding: .2rem .4rem;
                margin-right: .5rem;
            }
            .theme-icon {
                width: 14px;
                height: 14px;
            }
        }
    </style>
</head>
<body>
    <a href="#main" class="skip-link">Skip to main content</a>
    <!-- Modern Navigation -->
    <nav class="navbar navbar-expand-lg navbar-modern">
        <div class="container">
            <!-- Brand -->
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <div class="brand-container">
                    <img src="{{ url_for('static', filename='images/MainLogo.png') }}" alt="EdVice" class="brand-logo">
                    <div class="brand-text">
                        <span class="brand-name">EdVice</span>
                        <span class="brand-tagline">Career Guide</span>
                    </div>
                </div>
            </a>

            <!-- Mobile Toggle -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </button>

            <!-- Navigation Menu -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link {% if request.endpoint == 'index' %}active{% endif %}" href="{{ url_for('index') }}">
                            <i data-feather="home" class="nav-icon"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.endpoint in ['quiz','quiz_question'] %}active{% endif %}" href="{{ url_for('quiz') }}">
                            <i data-feather="clipboard" class="nav-icon"></i>
                            <span>Quiz</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.endpoint == 'career_explorer' %}active{% endif %}" href="{{ url_for('career_explorer') }}">
                            <i data-feather="compass" class="nav-icon"></i>
                            <span>Careers</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.endpoint == 'college_finder' %}active{% endif %}" href="{{ url_for('college_finder') }}">
                            <i data-feather="search" class="nav-icon"></i>
                            <span>Colleges</span>
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="servicesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i data-feather="grid" class="nav-icon"></i>
                            <span>Services</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-modern">
                            <li><a class="dropdown-item" href="{{ url_for('advanced.scholarships') }}">
                                <i data-feather="award" class="dropdown-icon"></i>
                                <span>Scholarships</span>
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('advanced.exams') }}">
                                <i data-feather="calendar" class="dropdown-icon"></i>
                                <span>Exam Calendar</span>
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('advanced.college_eligibility_checker') }}">
                                <i data-feather="check-circle" class="dropdown-icon"></i>
                                <span>Eligibility Checker</span>
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('advanced.career_simulator') }}">
                                <i data-feather="cpu" class="dropdown-icon"></i>
                                <span>Career Simulator</span>
                            </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('advanced.mentorship') }}">
                                <i data-feather="message-circle" class="dropdown-icon"></i>
                                <span>AI Mentor</span>
                            </a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.endpoint == 'about' %}active{% endif %}" href="{{ url_for('about') }}">
                            <i data-feather="info" class="nav-icon"></i>
                            <span>About</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if request.endpoint == 'contact' %}active{% endif %}" href="{{ url_for('contact') }}">
                            <i data-feather="mail" class="nav-icon"></i>
                            <span>Contact</span>
                        </a>
                    </li>
                </ul>

                <!-- Right Side Actions -->
                <div class="navbar-actions">
                    <!-- Theme Toggle -->
                    <div class="theme-toggle-container">
                        <button class="theme-toggle-btn" id="themeToggle" title="Toggle theme">
                            <i data-feather="sun" class="theme-icon sun-icon"></i>
                            <i data-feather="moon" class="theme-icon moon-icon"></i>
                        </button>
                    </div>

                    <!-- User Actions -->
                    {% if current_user.is_authenticated %}
                    <div class="user-menu">
                        <div class="user-avatar">
                            <img src="https://ui-avatars.com/api/?name={{ current_user.first_name }}+{{ current_user.last_name }}&background=6366f1&color=fff" alt="User Avatar">
                        </div>
                        <div class="dropdown">
                            <button class="user-dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                <span class="user-name">{{ current_user.first_name }}</span>
                                <i data-feather="chevron-down" class="dropdown-arrow"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end user-dropdown">
                                <li><a class="dropdown-item" href="{{ url_for('dashboard') }}">
                                    <i data-feather="layout" class="dropdown-icon"></i>
                                    <span>Dashboard</span>
                                </a></li>
                                <li><a class="dropdown-item" href="{{ url_for('advanced.notifications') }}">
                                    <i data-feather="bell" class="dropdown-icon"></i>
                                    <span>Notifications</span>
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">
                                    <i data-feather="log-out" class="dropdown-icon"></i>
                                    <span>Logout</span>
                                </a></li>
                            </ul>
                        </div>
                    </div>
                    {% else %}
                    <div class="auth-buttons">
                        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-primary btn-sm">Login</a>
                        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-sm">Sign Up</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="container mt-3">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <a href="{{ url_for('index') }}" class="d-inline-flex align-items-center text-decoration-none mb-3">
                        <img src="{{ url_for('static', filename='images/MainLogo.png') }}" alt="EdVise" class="navbar-logo me-2">
                        <span class="fw-bold fs-5">EdVise</span>
                    </a>
                    <p class="text-muted">Empowering students to make informed career decisions with personalized guidance and comprehensive information about government colleges.</p>
                </div>
                <div class="footer-section">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="{{ url_for('index') }}">Home</a></li>
                        <li class="mb-2"><a href="{{ url_for('quiz') }}">Aptitude Quiz</a></li>
                        <li class="mb-2"><a href="{{ url_for('career_explorer') }}">Career Explorer</a></li>
                        <li class="mb-2"><a href="{{ url_for('college_finder') }}">College Finder</a></li>
                        <li class="mb-2"><a href="{{ url_for('about') }}">About Us</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h6>Services</h6>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="{{ url_for('advanced.scholarships') }}">Scholarships</a></li>
                        <li class="mb-2"><a href="{{ url_for('advanced.exams') }}">Exam Calendar</a></li>
                        <li class="mb-2"><a href="{{ url_for('advanced.mentorship') }}">AI Mentor</a></li>
                        <li class="mb-2"><a href="{{ url_for('contact') }}">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h6>Connect With Us</h6>
                    <div class="d-flex gap-3 mb-3">
                        <a href="https://youtube.com/@techquesters-ai" class="text-muted" target="_blank">
                            <i data-feather="youtube" class="icon"></i>
                        </a>
                        <a href="#" class="text-muted">
                            <i data-feather="twitter" class="icon"></i>
                        </a>
                        <a href="https://www.instagram.com/tech_questers2k24" class="text-muted" target="_blank">
                            <i data-feather="instagram" class="icon"></i>
                        </a>
                        <a href="https://www.linkedin.com/company/tech-questers/" class="text-muted" target="_blank">
                            <i data-feather="linkedin" class="icon"></i>
                        </a>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <i data-feather="check-circle" class="text-success me-2 icon-sm"></i>
                        <small class="text-muted">Supported by Digital India</small>
                    </div>
                    <div class="d-flex align-items-center">
                        <i data-feather="check-circle" class="text-success me-2 icon-sm"></i>
                        <small class="text-muted">Ministry of Education Initiative</small>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
            <div class="row align-items-center">
                <div class="col-md-6">
                        <small>&copy; 2025 EdVise. All rights reserved.</small>
                </div>
                <div class="col-md-6 text-md-end">
                        <small>Made with ❤️ for Indian Students</small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Initialize Feather Icons and theme switch -->
    <script>
        // Initialize Feather Icons safely
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        });
        
        // Modern Theme switcher
        (function(){
            const root = document.documentElement;
            const key = 'edvise-theme';
            const saved = localStorage.getItem(key);
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const initialTheme = saved || (prefersDark ? 'dark' : 'light');
            
            // Set initial theme
            root.setAttribute('data-theme', initialTheme);
            
            document.addEventListener('DOMContentLoaded', function() {
                const themeToggle = document.getElementById('themeToggle');
                
                // Theme change handler
                const changeTheme = () => {
                    const currentTheme = root.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    root.setAttribute('data-theme', newTheme); 
                    localStorage.setItem(key, newTheme);
                    
                    // Add visual feedback
                    if (themeToggle) {
                        themeToggle.style.transform = 'scale(0.9)';
                        setTimeout(() => {
                            themeToggle.style.transform = 'scale(1)';
                        }, 150);
                    }
                    
                    // Re-initialize Feather icons after theme change
                    setTimeout(() => {
                        if (typeof feather !== 'undefined') {
                            feather.replace();
                        }
                    }, 50);
                };
                
                // Event listener for theme toggle
                if(themeToggle) {
                    themeToggle.addEventListener('click', changeTheme);
                }
                
                // Listen for system theme changes
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                    if (!localStorage.getItem(key)) {
                        const newTheme = e.matches ? 'dark' : 'light';
                        root.setAttribute('data-theme', newTheme);
                        if (typeof feather !== 'undefined') {
                            feather.replace();
                        }
                    }
                });
            });
        })();
    </script>
    
    <!-- Chatbot widget -->
    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
    <!-- Site animations -->
    <script src="{{ url_for('static', filename='js/animations.js') }}"></script>
    {% block extra_scripts %}{% endblock %}
</body>
</html>
